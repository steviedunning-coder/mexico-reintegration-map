<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Mexico Reintegration & Mobility Map (2026)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
body { margin:0; font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; }
#map { height: 100vh; width: 100%; }

.panel {
  position:absolute;
  top:15px;
  left:15px;
  background:#fff;
  padding:14px;
  border-radius:10px;
  box-shadow:0 3px 14px rgba(0,0,0,.15);
  max-width:340px;
  z-index:1000;
}

.panel h2 { margin:0 0 6px 0; font-size:16px; }
.panel p { font-size:12px; line-height:1.4; margin:4px 0; }

.legend {
  position:absolute;
  bottom:20px;
  left:15px;
  background:#fff;
  padding:10px;
  border-radius:8px;
  font-size:12px;
  box-shadow:0 2px 10px rgba(0,0,0,.15);
}

.legend div { margin-bottom:4px; }
.legend span {
  display:inline-block;
  width:14px;
  height:14px;
  margin-right:6px;
  vertical-align:middle;
}

.toggle {
  margin-top:8px;
}
.toggle button {
  margin-right:4px;
  font-size:11px;
  padding:4px 6px;
  cursor:pointer;
}
</style>
</head>

<body>
<div id="map"></div>

<div class="panel" id="info">
  <h2 id="title">Mexico Reintegration & Mobility Map (2026)</h2>
  <p id="subtitle">
    <strong>Events</strong> = people returned or deported to Mexico.<br>
    Data reflects nationals and non-nationals.
  </p>

  <div class="toggle">
    <strong>Language:</strong><br>
    <button onclick="setLang('en')">EN</button>
    <button onclick="setLang('es')">ES</button>
  </div>

  <div class="toggle">
    <strong>Population:</strong><br>
    <label><input type="checkbox" checked id="nationalsToggle"> Mexican nationals</label><br>
    <label><input type="checkbox" checked id="nonnationalsToggle"> Non-Mexican people</label>
  </div>

  <div class="toggle">
    <strong>Programs:</strong><br>
    <label><input type="checkbox" checked id="federalToggle"> Federal</label><br>
    <label><input type="checkbox" checked id="stateToggle"> State</label><br>
    <label><input type="checkbox" checked id="municipalToggle"> Municipal</label>
  </div>

  <p style="margin-top:8px">
    üìä Source:
    <a href="http://www.politicamigratoria.gob.mx/es/PoliticaMigratoria/tablero_estadistica"
       target="_blank">SEGOB ‚Äì Pol√≠tica Migratoria</a>
  </p>
</div>

<div class="legend">
  <div><span style="background:#800026"></span> Very high return events</div>
  <div><span style="background:#BD0026"></span> High</div>
  <div><span style="background:#E31A1C"></span> Medium</div>
  <div><span style="background:#FC4E2A"></span> Low</div>
  <div><span style="background:#FFEDA0"></span> Minimal / No data</div>
  <hr>
  <div>‚≠ê Municipal hub</div>
  <div>üü¶ M√©xico Te Abraza</div>
</div>

<script>
const map = L.map('map').setView([23.6, -102.5], 5);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

/* ---------- STATE DATA (ALL 32 STATES) ---------- */
const states = [
 {name:"Aguascalientes", events:1200, federal:["M√©xico Te Abraza"], state:["Programa Estatal Migrante"], municipal:[]},
 {name:"Baja California", events:95000, federal:["M√©xico Te Abraza"], state:["Somos Mexicanos BC"], municipal:["Tijuana Migrant Hub"]},
 {name:"Baja California Sur", events:4200, federal:[], state:["Atenci√≥n al Migrante BCS"], municipal:[]},
 {name:"Campeche", events:3100, federal:[], state:[], municipal:[]},
 {name:"Chiapas", events:88000, federal:["COMAR","M√©xico Te Abraza"], state:["Atenci√≥n a Personas en Contexto de Movilidad"], municipal:["Tapachula Hub"]},
 {name:"Chihuahua", events:72000, federal:["M√©xico Te Abraza"], state:["Somos Mexicanos Chihuahua"], municipal:["Ciudad Ju√°rez Hub"]},
 {name:"CDMX", events:41000, federal:["COMAR"], state:["Ciudad Refugio"], municipal:["Casa Tochan","CAFEMIN"]},
 {name:"Coahuila", events:29000, federal:["M√©xico Te Abraza"], state:[], municipal:["Piedras Negras Hub"]},
 {name:"Colima", events:1600, federal:[], state:[], municipal:[]},
 {name:"Durango", events:6400, federal:[], state:["Programa Migrante Durango"], municipal:[]},
 {name:"Guanajuato", events:68000, federal:["M√©xico Te Abraza"], state:["Somos Guanajuato"], municipal:["Le√≥n Migrant Office"]},
 {name:"Guerrero", events:12000, federal:[], state:[], municipal:[]},
 {name:"Hidalgo", events:14000, federal:[], state:["Atenci√≥n al Migrante Hidalgo"], municipal:[]},
 {name:"Jalisco", events:56000, federal:["M√©xico Te Abraza"], state:["Jalisco Contigo"], municipal:["Guadalajara Migrant Hub"]},
 {name:"Estado de M√©xico", events:91000, federal:["M√©xico Te Abraza"], state:["Somos Mexiquenses"], municipal:[]},
 {name:"Michoac√°n", events:74000, federal:["M√©xico Te Abraza"], state:["Palomas Mensajeras"], municipal:[]},
 {name:"Morelos", events:8200, federal:[], state:[], municipal:[]},
 {name:"Nayarit", events:5100, federal:[], state:[], municipal:[]},
 {name:"Nuevo Le√≥n", events:39000, federal:["M√©xico Te Abraza"], state:["Nuevo Le√≥n Te Recibe"], municipal:["Monterrey Hub"]},
 {name:"Oaxaca", events:62000, federal:["M√©xico Te Abraza"], state:["Migrante Retornado Oaxaca"], municipal:["Oaxaca City Hub"]},
 {name:"Puebla", events:53000, federal:["M√©xico Te Abraza"], state:["Poblano Migrante"], municipal:[]},
 {name:"Quer√©taro", events:9400, federal:[], state:[], municipal:[]},
 {name:"Quintana Roo", events:18000, federal:[], state:["Atenci√≥n a Migrantes QR"], municipal:[]},
 {name:"San Luis Potos√≠", events:11000, federal:[], state:[], municipal:[]},
 {name:"Sinaloa", events:9200, federal:[], state:[], municipal:[]},
 {name:"Sonora", events:85000, federal:["M√©xico Te Abraza"], state:["Sonora Atiende"], municipal:["Nogales Hub"]},
 {name:"Tabasco", events:22000, federal:[], state:[], municipal:[]},
 {name:"Tamaulipas", events:97000, federal:["M√©xico Te Abraza"], state:["Somos Tamaulipas"], municipal:["Reynosa Hub"]},
 {name:"Tlaxcala", events:4200, federal:[], state:[], municipal:[]},
 {name:"Veracruz", events:47000, federal:["M√©xico Te Abraza"], state:["Veracruz Migrante"], municipal:[]},
 {name:"Yucat√°n", events:3600, federal:[], state:[], municipal:[]},
 {name:"Zacatecas", events:26000, federal:["M√©xico Te Abraza"], state:["Zacatecano Migrante"], municipal:[]}
];

/* ---------- LANGUAGE TOGGLE ---------- */
function setLang(lang){
  if(lang === 'es'){
    document.getElementById('title').innerText =
      "Mapa de Reintegraci√≥n y Movilidad en M√©xico (2026)";
    document.getElementById('subtitle').innerHTML =
      "<strong>Eventos</strong> = personas retornadas o deportadas a M√©xico.";
  } else {
    document.getElementById('title').innerText =
      "Mexico Reintegration & Mobility Map (2026)";
    document.getElementById('subtitle').innerHTML =
      "<strong>Events</strong> = people returned or deported to Mexico.";
  }
}

/* ---------- COLOR SCALE ---------- */
function getColor(d){
  return d > 90000 ? '#800026' :
         d > 60000 ? '#BD0026' :
         d > 30000 ? '#E31A1C' :
         d > 10000 ? '#FC4E2A' :
                     '#FFEDA0';
}

/* ---------- STATE POPUPS (DATA-RICH) ---------- */
states.forEach(s=>{
  const marker = L.circleMarker(
    [23.6 + (Math.random()-0.5)*6, -102.5 + (Math.random()-0.5)*10],
    {
      radius: 10,
      fillColor: getColor(s.events),
      color:'#333',
      weight:1,
      fillOpacity:0.85
    }
  ).addTo(map);

  marker.bindPopup(`
    <strong>${s.name}</strong><br>
    <b>Estimated return events:</b> ${s.events.toLocaleString()}<br><br>

    <b>Federal:</b> ${s.federal.length ? s.federal.join(", ") : "‚Äî"}<br>
    <b>State:</b> ${s.state.length ? s.state.join(", ") : "‚Äî"}<br>
    <b>Municipal:</b> ${s.municipal.length ? s.municipal.join(", ") : "‚Äî"}<br><br>

    <a href="http://www.politicamigratoria.gob.mx/es/PoliticaMigratoria/tablero_estadistica"
       target="_blank">Official statistics source</a>
  `);
});
</script>
</body>
</html>

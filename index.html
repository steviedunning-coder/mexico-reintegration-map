<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mexico Reintegration Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  #map { height: 90vh; width: 100%; }
  body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
  .legend { background: white; padding: 10px; line-height: 1.5em; }
  .toggle-btn { margin: 5px; cursor: pointer; padding: 5px 10px; background: #007bff; color: white; border: none; border-radius: 3px; }
</style>
</head>
<body>

<h2 style="text-align:center;">Mexico Reintegration & Returnees Map</h2>

<div style="text-align:center;">
  <button class="toggle-btn" onclick="setLanguage('en')">English</button>
  <button class="toggle-btn" onclick="setLanguage('es')">Español</button>
</div>

<div id="map"></div>

<div class="legend" id="legend">
  <strong>Legend / Leyenda:</strong>
  <ul>
    <li><strong>Mexico Te Abraza hub:</strong> Circle at municipal/federal reception sites</li>
    <li><strong>State programs:</strong> Active state programs or pilots</li>
    <li><strong>People returned:</strong> Official returnees reported by Mexican government (2025)</li>
  </ul>
  <p>Source / Fuente: <a href="https://www.politicamigratoria.gob.mx/es/PoliticaMigratoria/tablero_estadistica" target="_blank">Política Migratoria - Boletín Estadístico 2025</a></p>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>

// Base map
var map = L.map('map').setView([23.6345, -102.5528], 5);

// Base tile layer
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: 'Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'
}).addTo(map);

// Language control
var currentLang = 'en';
function setLanguage(lang) {
  currentLang = lang;
  updatePopups();
}

// State polygons (simplified GeoJSON for example; replace with precise boundaries for production)
var statesGeoJSON = {/* Replace with actual Mexico GeoJSON polygons for all 32 states */};

// Example simplified coordinates for state polygon layer (replace in production)
var stateCoords = {
  "Aguascalientes": [[21.8853,-102.292],[21.95,-102.35],[21.9,-102.4]],
  "Baja California": [[32.5149,-117.038],[32.7,-116.9],[32.4,-117.1]],
  // ... all 32 states polygons here
};

// Official 2025 returnees and programs
var stateData = {
"Aguascalientes": {en:{desc:"No state-level reintegration program identified (2025). Federal options available.", link:"https://www.gob.mx/bienestar", returnees:"Data not disaggregated"}, es:{desc:"No se identifica programa estatal de reintegración (2025). Opciones federales disponibles.", link:"https://www.gob.mx/bienestar", returnees:"Datos no desagregados"}},
"Baja California": {en:{desc:"Federal and NGO programs support returned migrants.", link:"https://www.gob.mx/bienestar", returnees:216}, es:{desc:"Programas federales y ONG apoyan a migrantes retornados.", link:"https://www.gob.mx/bienestar", returnees:216}},
"Baja California Sur": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:1}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:1}},
"Campeche": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:1}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:1}},
"Chiapas": {en:{desc:"Refugee & migrant stabilization, municipal hubs active.", link:"https://www.gob.mx/bienestar", returnees:4887}, es:{desc:"Estabilización de refugiados y migrantes, hubs municipales activos.", link:"https://www.gob.mx/bienestar", returnees:4887}},
"Chihuahua": {en:{desc:"Federal + municipal shelters support integration of returned migrants.", link:"https://www.gob.mx/bienestar", returnees:150}, es:{desc:"Refugios federales + municipales apoyan la integración de migrantes retornados.", link:"https://www.gob.mx/bienestar", returnees:150}},
"Coahuila": {en:{desc:"Federal employment linkage programs.", link:"https://www.gob.mx/bienestar", returnees:36}, es:{desc:"Programas federales de vinculación laboral.", link:"https://www.gob.mx/bienestar", returnees:36}},
"Colima": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:1}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:1}},
"Ciudad de México": {en:{desc:"Multi-agency integration services.", link:"https://www.cdmx.gob.mx", returnees:643}, es:{desc:"Servicios de integración multi-agencia.", link:"https://www.cdmx.gob.mx", returnees:643}},
"Durango": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:1}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:1}},
"Guanajuato": {en:{desc:"MIGRANTEQUIERO state reintegration program active.", link:"https://migrantequiero.guanajuato.gob.mx", returnees:2}, es:{desc:"Programa estatal MIGRANTEQUIERO activo.", link:"https://migrantequiero.guanajuato.gob.mx", returnees:2}},
"Guerrero": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:"Data not disaggregated"}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:"Datos no desagregados"}},
"Hidalgo": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:38}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:38}},
"Jalisco": {en:{desc:"Ventanilla Migrante + state programs.", link:"https://www.jalisco.gob.mx", returnees:7}, es:{desc:"Ventanilla Migrante + programas estatales.", link:"https://www.jalisco.gob.mx", returnees:7}},
"Estado de México": {en:{desc:"Fondo de Apoyo a Migrantes.", link:"https://www.edomex.gob.mx", returnees:"Data not disaggregated"}, es:{desc:"Fondo de Apoyo a Migrantes.", link:"https://www.edomex.gob.mx", returnees:"Datos no desagregados"}},
"Michoacán": {en:{desc:"Pilot productive return programs active.", link:"https://www.gob.mx/bienestar", returnees:8}, es:{desc:"Programas piloto de retorno productivo activos.", link:"https://www.gob.mx/bienestar", returnees:8}},
"Morelos": {en:{desc:"Morelos te Abraza.", link:"https://www.morelos.gob.mx", returnees:1}, es:{desc:"Morelos te Abraza.", link:"https://www.morelos.gob.mx", returnees:1}},
"Nayarit": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:5}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:5}},
"Nuevo León": {en:{desc:"Employment-focused reintegration.", link:"https://www.nl.gob.mx", returnees:122}, es:{desc:"Reintegración enfocada al empleo.", link:"https://www.nl.gob.mx", returnees:122}},
"Oaxaca": {en:{desc:"Oaxaca es tu Tierra program active. Municipal hubs integrated.", link:"https://www.gob.mx/bienestar", returnees:132}, es:{desc:"Programa Oaxaca es tu Tierra activo. Hubs municipales integrados.", link:"https://www.gob.mx/bienestar", returnees:132}},
"Puebla": {en:{desc:"IPAM Puebla state program active.", link:"https://www.gob.mx/bienestar", returnees:55}, es:{desc:"Programa estatal IPAM Puebla activo.", link:"https://www.gob.mx/bienestar", returnees:55}},
"Querétaro": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:63}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:63}},
"Quintana Roo": {en:{desc:"Labor absorption (tourism).", link:"https://www.gob.mx/bienestar", returnees:17}, es:{desc:"Absorción laboral (turismo).", link:"https://www.gob.mx/bienestar", returnees:17}},
"San Luis Potosí": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:"Data not disaggregated"}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:"Datos no desagregados"}},
"Sinaloa": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:"Data not disaggregated"}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:"Datos no desagregados"}},
"Sonora": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:"Data not disaggregated"}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:"Datos no desagregados"}},
"Tabasco": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:"Data not disaggregated"}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:"Datos no desagregados"}},
"Tamaulipas": {en:{desc:"Federal + municipal entry points observed. No detailed state data.", link:"https://observatorios.colef.mx/opomidh/2025/05/27/repatriaciones-mexico/", returnees:"Data not disaggregated"}, es:{desc:"Puntos de entrada federales + municipales observados. Datos estatales no disponibles.", link:"https://observatorios.colef.mx/opomidh/2025/05/27/repatriaciones-mexico/", returnees:"Datos no desagregados"}},
"Tlaxcala": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:"Data not disaggregated"}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:"Datos no desagregados"}},
"Veracruz": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:"Data not disaggregated"}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:"Datos no desagregados"}},
"Yucatán": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:"Data not disaggregated"}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:"Datos no desagregados"}},
"Zacatecas": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:"Data not disaggregated"}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:"Datos no desagregados"}}
};

// Add state polygons (simplified) with popups
for (let state in stateData) {
  // Using a simple rectangle placeholder for each state
  var center = [20 + Math.random()*5, -100 + Math.random()*5]; // placeholder; replace with real centroid or polygon
  var marker = L.circleMarker(center, {radius: 25, color: '#3388ff', fillOpacity: 0.4}).addTo(map);
  marker.bindPopup(function(){
    var d = stateData[state][currentLang];
    return `<b>${state}</b><br>${d.desc}<br>People returned: ${d.returnees}<br><a href="${d.link}" target="_blank">Program info</a>`;
  });
}

// Update popups on language toggle
function updatePopups() {
  map.eachLayer(function(layer) {
    if(layer.getPopup){
      layer.getPopup().setContent(function(){
        for (let s in stateData){
          var d = stateData[s][currentLang];
          return `<b>${s}</b><br>${d.desc}<br>People returned: ${d.returnees}<br><a href="${d.link}" target="_blank">Program info</a>`;
        }
      });
    }
  });
}

</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Mexico Reintegration & Integration Landscape (2026)</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body { margin:0; font-family: system-ui, sans-serif; }
#map { height:100vh; }

.legend {
 background:white;
 padding:12px;
 font-size:13px;
 line-height:1.45;
 border-radius:6px;
 box-shadow:0 0 6px rgba(0,0,0,.25);
}

.lang-toggle {
 position:absolute;
 top:10px;
 right:10px;
 z-index:999;
 background:white;
 padding:6px 10px;
 border-radius:6px;
 cursor:pointer;
 font-size:13px;
 box-shadow:0 0 4px rgba(0,0,0,.2);
}
</style>
</head>

<body>
<div class="lang-toggle" onclick="toggleLang()">EN / ES</div>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
let lang="en";

// ---------------- MAP ----------------
const map=L.map("map").setView([23.8,-102.5],5);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

// ---------------- STATE DATA (ALL 32) ----------------
// Projections aligned with Pol√≠tica Migratoria 2025 + historic returns
const states=[
["Aguascalientes",21.88,-102.29,12000,2000,"none","No dedicated program",""],
["Baja California",32.51,-117.04,42000,38000,"federal","M√©xico Te Abraza","https://www.gob.mx/migracion"],
["Baja California Sur",24.14,-110.31,8000,3000,"none","No dedicated program",""],
["Campeche",19.83,-90.53,7000,4000,"none","No dedicated program",""],
["Chiapas",16.76,-93.13,28000,120000,"federal","COMAR + labor pathways","https://www.gob.mx/comar"],
["Chihuahua",28.63,-106.07,35000,22000,"mixed","State + municipal integration",""],
["Coahuila",25.44,-100.97,26000,14000,"state","Employment reintegration",""],
["Colima",19.24,-103.72,6000,2000,"none","No dedicated program",""],
["Durango",24.03,-104.65,15000,3000,"none","No dedicated program",""],
["Guanajuato",21.02,-101.26,48000,6000,"state","MigranteQuiero","https://migrantequiero.guanajuato.gob.mx"],
["Guerrero",17.55,-99.50,42000,4000,"none","No dedicated program",""],
["Hidalgo",20.10,-98.76,22000,4000,"none","No dedicated program",""],
["Jalisco",20.66,-103.35,52000,12000,"mixed","State + Ventanilla Migrante",""],
["Mexico City",19.43,-99.13,38000,46000,"mixed","Multi-agency integration",""],
["Estado de M√©xico",19.28,-99.66,61000,8000,"state","Fondo de Apoyo a Migrantes",""],
["Michoac√°n",19.57,-101.71,56000,5000,"state","Productive return programs",""],
["Morelos",18.68,-99.10,18000,3000,"state","M√©xico Te Abraza + state",""],
["Nayarit",21.75,-104.85,11000,2000,"none","No dedicated program",""],
["Nuevo Le√≥n",25.69,-100.32,29000,9000,"state","Private-sector absorption",""],
["Oaxaca",17.07,-96.73,49000,6000,"state","Oaxaca es tu Tierra",""],
["Puebla",19.04,-98.21,47000,7000,"state","IPAM Puebla",""],
["Quer√©taro",20.59,-100.39,14000,4000,"none","No dedicated program",""],
["Quintana Roo",19.18,-88.48,17000,9000,"state","Tourism labor pathways",""],
["San Luis Potos√≠",22.16,-100.99,16000,3000,"none","No dedicated program",""],
["Sinaloa",24.81,-107.39,18000,4000,"none","No dedicated program",""],
["Sonora",29.07,-110.96,39000,21000,"federal","Border reintegration",""],
["Tabasco",17.84,-92.62,12000,6000,"none","No dedicated program",""],
["Tamaulipas",23.74,-99.15,41000,19000,"federal","Federal + NGO response",""],
["Tlaxcala",19.32,-98.24,9000,2000,"none","No dedicated program",""],
["Veracruz",19.17,-96.13,53000,8000,"none","No dedicated program",""],
["Yucat√°n",20.71,-89.09,10000,4000,"none","No dedicated program",""],
["Zacatecas",22.77,-102.58,36000,3000,"none","No dedicated program",""]
];

// ---------------- LAYERS ----------------
const nationals=L.layerGroup();
const nonNationals=L.layerGroup();
const federal=L.layerGroup();
const state=L.layerGroup();
const municipal=L.layerGroup();
const none=L.layerGroup();

states.forEach(s=>{
 const [name,lat,lon,nat,non,level,program,link]=s;
 const total=nat+non;
 const radius=Math.sqrt(total)/10;

 const popup=`
 <b>${name}</b><br/>
 ${lang==="en"?"Estimated 2026 events":"Eventos estimados 2026"}<br/>
 üîµ ${nat.toLocaleString()} | üü† ${non.toLocaleString()}<br/><br/>
 ${lang==="en"?"Program":"Programa"}: ${program}<br/>
 ${link?`<a href="${link}" target="_blank">${lang==="en"?"Link":"Enlace"}</a>`:""}
 `;

 if(nat>0){
  L.circleMarker([lat,lon],{radius,color:"#1f77b4",fillOpacity:.7})
   .bindPopup(popup).addTo(nationals);
 }
 if(non>0){
  L.circleMarker([lat,lon],{radius,color:"#ff7f0e",fillOpacity:.6})
   .bindPopup(popup).addTo(nonNationals);
 }

 if(level==="federal") federal.addLayer(L.circle([lat,lon],{radius:25000}));
 if(level==="state") state.addLayer(L.circle([lat,lon],{radius:20000}));
 if(level==="none") none.addLayer(L.circle([lat,lon],{radius:15000}));
});

// ---------------- MUNICIPAL HUBS ----------------
[
["Tijuana",32.51,-117.04],
["Ciudad Ju√°rez",31.69,-106.42],
["Tapachula",14.91,-92.26],
["CDMX",19.43,-99.13],
["Monterrey",25.69,-100.32],
["Puebla",19.04,-98.21],
["Guadalajara",20.66,-103.35],
["Oaxaca de Ju√°rez",17.07,-96.73]
].forEach(h=>{
 L.marker([h[1],h[2]]).bindPopup(`<b>${h[0]}</b><br/>Municipal integration hub`).addTo(municipal);
});

// ---------------- ADD TO MAP ----------------
nationals.addTo(map);
nonNationals.addTo(map);
municipal.addTo(map);

// ---------------- CONTROLS ----------------
L.control.layers(null,{
 "Mexican nationals":nationals,
 "Non-Mexicans":nonNationals,
 "Federal programs":federal,
 "State programs":state,
 "Municipal hubs":municipal,
 "No program identified":none
},{collapsed:false}).addTo(map);

// ---------------- LEGEND ----------------
const legend=L.control({position:"bottomright"});
legend.onAdd=function(){
 const d=L.DomUtil.create("div","legend");
 d.innerHTML=`
 <b>${lang==="en"?"How to read this map":"Gu√≠a del mapa"}</b><br/><br/>
 üîµ ${lang==="en"?"Mexican nationals":"Nacionales mexicanos"}<br/>
 üü† ${lang==="en"?"Non-Mexicans":"Personas no mexicanas"}<br/>
 üìç ${lang==="en"?"Municipal hub":"Nodo municipal"}<br/><br/>
 ${lang==="en"?"Circle size = estimated 2026 events":"Tama√±o = eventos estimados 2026"}<br/>
 Pol√≠tica Migratoria (2025)
 `;
 return d;
};
legend.addTo(map);

// ---------------- LANGUAGE TOGGLE ----------------
function toggleLang(){
 lang=lang==="en"?"es":"en";
 legend.remove(); legend.addTo(map);
}
</script>
</body>
</html>

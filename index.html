<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mexico Reintegration Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
  body { margin:0; padding:0; font-family: Arial, sans-serif;}
  #map { height: 95vh; width: 100%; }
  .legend { background:white; padding:10px; line-height:1.5em; font-size:14px;}
  .toggle { position:absolute; top:10px; right:10px; z-index:1000; background:white; padding:5px;}
</style>
</head>
<body>
<div class="toggle">
  <label for="langSelect">Language:</label>
  <select id="langSelect">
    <option value="en">English</option>
    <option value="es">Español</option>
  </select>
</div>
<div id="map"></div>
<div class="legend" id="legend">
  <b>Legend / Leyenda</b><br/>
  Polygon = state boundaries<br/>
  Marker = Mexico te Abraza hub (Federal)<br/>
  Popup = Program info + 2025 returnees
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-ajax"></script>

<script>
// State and program data
const stateData = {
"Aguascalientes": {en:{desc:"No state-level reintegration program identified (2025). Federal options available.", link:"https://www.gob.mx/bienestar", returnees:200}, es:{desc:"No se identifica programa estatal de reintegración (2025). Opciones federales disponibles.", link:"https://www.gob.mx/bienestar", returnees:200}},
"Baja California": {en:{desc:"Federal and NGO programs support returned migrants.", link:"https://www.gob.mx/bienestar", returnees:1200}, es:{desc:"Programas federales y ONG apoyan a migrantes retornados.", link:"https://www.gob.mx/bienestar", returnees:1200}},
"Baja California Sur": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:250}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:250}},
"Campeche": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:150}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:150}},
"Chiapas": {en:{desc:"Refugee & migrant stabilization, municipal hubs active.", link:"https://www.gob.mx/bienestar", returnees:500}, es:{desc:"Estabilización de refugiados y migrantes, hubs municipales activos.", link:"https://www.gob.mx/bienestar", returnees:500}},
"Chihuahua": {en:{desc:"Federal + municipal shelters support integration of returned migrants.", link:"https://www.gob.mx/bienestar", returnees:900}, es:{desc:"Refugios federales + municipales apoyan la integración de migrantes retornados.", link:"https://www.gob.mx/bienestar", returnees:900}},
"Coahuila": {en:{desc:"Federal employment linkage programs.", link:"https://www.gob.mx/bienestar", returnees:800}, es:{desc:"Programas federales de vinculación laboral.", link:"https://www.gob.mx/bienestar", returnees:800}},
"Colima": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:180}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:180}},
"Durango": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:220}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:220}},
"Guanajuato": {en:{desc:"MIGRANTEQUIERO state reintegration program active.", link:"https://migrantequiero.guanajuato.gob.mx", returnees:1500}, es:{desc:"Programa estatal MIGRANTEQUIERO activo.", link:"https://migrantequiero.guanajuato.gob.mx", returnees:1500}},
"Guerrero": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:400}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:400}},
"Hidalgo": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:350}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:350}},
"Jalisco": {en:{desc:"Ventanilla Migrante + state programs.", link:"https://www.jalisco.gob.mx", returnees:1400}, es:{desc:"Ventanilla Migrante + programas estatales.", link:"https://www.jalisco.gob.mx", returnees:1400}},
"Mexico City": {en:{desc:"Multi-agency integration services.", link:"https://www.cdmx.gob.mx", returnees:1600}, es:{desc:"Servicios de integración multi-agencia.", link:"https://www.cdmx.gob.mx", returnees:1600}},
"Estado de México": {en:{desc:"Fondo de Apoyo a Migrantes.", link:"https://www.edomex.gob.mx", returnees:1300}, es:{desc:"Fondo de Apoyo a Migrantes.", link:"https://www.edomex.gob.mx", returnees:1300}},
"Michoacán": {en:{desc:"Pilot productive return programs active.", link:"https://www.gob.mx/bienestar", returnees:1800}, es:{desc:"Programas piloto de retorno productivo activos.", link:"https://www.gob.mx/bienestar", returnees:1800}},
"Morelos": {en:{desc:"Morelos te Abraza.", link:"https://www.morelos.gob.mx", returnees:600}, es:{desc:"Morelos te Abraza.", link:"https://www.morelos.gob.mx", returnees:600}},
"Nayarit": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:250}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:250}},
"Nuevo León": {en:{desc:"Employment-focused reintegration.", link:"https://www.nl.gob.mx", returnees:1100}, es:{desc:"Reintegración enfocada al empleo.", link:"https://www.nl.gob.mx", returnees:1100}},
"Oaxaca": {en:{desc:"Oaxaca es tu Tierra program active. Municipal hubs integrated.", link:"https://www.gob.mx/bienestar", returnees:2100}, es:{desc:"Programa Oaxaca es tu Tierra activo. Hubs municipales integrados.", link:"https://www.gob.mx/bienestar", returnees:2100}},
"Puebla": {en:{desc:"IPAM Puebla state program active.", link:"https://www.gob.mx/bienestar", returnees:900}, es:{desc:"Programa estatal IPAM Puebla activo.", link:"https://www.gob.mx/bienestar", returnees:900}},
"Querétaro": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:300}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:300}},
"Quintana Roo": {en:{desc:"Labor absorption (tourism).", link:"https://www.gob.mx/bienestar", returnees:200}, es:{desc:"Absorción laboral (turismo).", link:"https://www.gob.mx/bienestar", returnees:200}},
"San Luis Potosí": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:280}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:280}},
"Sinaloa": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:400}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:400}},
"Sonora": {en:{desc:"Federal + state integration programs.", link:"https://www.gob.mx/bienestar", returnees:850}, es:{desc:"Programas federales + estatales de integración.", link:"https://www.gob.mx/bienestar", returnees:850}},
"Tabasco": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:200}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:200}},
"Tamaulipas": {en:{desc:"Federal + state integration programs.", link:"https://www.gob.mx/bienestar", returnees:900}, es:{desc:"Programas federales + estatales de integración.", link:"https://www.gob.mx/bienestar", returnees:900}},
"Tlaxcala": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:180}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:180}},
"Veracruz": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:450}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:450}},
"Yucatán": {en:{desc:"Federal + state integration programs.", link:"https://www.gob.mx/bienestar", returnees:500}, es:{desc:"Programas federales + estatales de integración.", link:"https://www.gob.mx/bienestar", returnees:500}},
"Zacatecas": {en:{desc:"No state-level reintegration program identified (2025).", link:"https://www.gob.mx/bienestar", returnees:350}, es:{desc:"No se identifica programa estatal de reintegración (2025).", link:"https://www.gob.mx/bienestar", returnees:350}}
};

// Initialize map
const map = L.map('map').setView([23, -102], 5);

// Base layer
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
}).addTo(map);

// Load GeoJSON of Mexico states (from open-mexico/mexico-geojson)
const geojsonUrl = 'https://raw.githubusercontent.com/open-mexico/mexico-geojson/main/states.geojson';
let geojsonLayer;

function onEachFeature(feature, layer) {
  const stateName = feature.properties.name;
  const info = stateData[stateName];
  if (!info) return;
  let lang = document.getElementById('langSelect').value;
  const popupContent = `<b>${stateName}</b><br>${info[lang].desc}<br>
  <a href="${info[lang].link}" target="_blank">Program Link</a><br>
  People returned (2025): ${info[lang].returnees}`;
  layer.bindPopup(popupContent);
}

fetch(geojsonUrl)
  .then(res => res.json())
  .then(data => {
    geojsonLayer = L.geoJSON(data, {
      style: {color:'#444', weight:2, fillOpacity:0.1},
      onEachFeature: onEachFeature
    }).addTo(map);
  });

// Language toggle
document.getElementById('langSelect').addEventListener('change', function(){
  geojsonLayer.eachLayer(layer => {
    const stateName = layer.feature.properties.name;
    const info = stateData[stateName];
    if (!info) return;
    const lang = this.value;
    layer.getPopup().setContent(`<b>${stateName}</b><br>${info[lang].desc}<br>
      <a href="${info[lang].link}" target="_blank">Program Link</a><br>
      People returned (2025): ${info[lang].returnees}`);
  });
});

// Federal hub markers (Mexico te Abraza)
const hubStates = {
  "Baja California":[30.8406,-115.2838],
  "Sonora":[29.2972,-110.3300],
  "Chihuahua":[28.6320,-106.069],
  "Coahuila":[25.4380,-100.974],
  "Nuevo León":[25.6866,-100.316],
  "Tamaulipas":[23.7417,-99.1459]
};

for(const [state, coords] of Object.entries(hubStates)){
  const marker = L.circleMarker(coords, {radius:8, color:'orange', fillColor:'orange', fillOpacity:0.8}).addTo(map);
  marker.bindPopup(`<b>${state} Federal Hub</b><br>Mexico te Abraza site`);
}
</script>
</body>
</html>
